"0","# とりあえずlmとStepでやってみる"
"0","tempBoston <- BostonHousing"
"0","tempBoston$chas <- as.numeric(tempBoston$chas)"
"0","tempBoston[1:13] <- tempBoston[1:13] |>  scale()"
"0","lm_model <- lm(medv~ ., data=tempBoston)"
"0","step(lm_model) %>% summary()"
"1","Start:  AIC="
"1",""
"1","1589.64"
"1",""
"1","
"
"1",""
"1","medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + "
"1",""
"1","
    tax + ptratio + b + lstat"
"1",""
"1","

"
"1","         "
"1"," Df"
"1"," Sum of Sq"
"1","   RSS"
"1","    AIC"
"1","
- age    "
"1","  1"
"1","      0.06"
"1"," 11079"
"1"," 1587.7"
"1","
- indus  "
"1","  1"
"1","      2.52"
"1"," 11081"
"1"," 1587.8"
"1","
<none>   "
"1","   "
"1","          "
"1"," 11079"
"1"," 1589.6"
"1","
- chas   "
"1","  1"
"1","    218.97"
"1"," 11298"
"1"," 1597.5"
"1","
- tax    "
"1","  1"
"1","    242.26"
"1"," 11321"
"1"," 1598.6"
"1","
- crim   "
"1","  1"
"1","    243.22"
"1"," 11322"
"1"," 1598.6"
"1","
- zn     "
"1","  1"
"1","    257.49"
"1"," 11336"
"1"," 1599.3"
"1","
- b      "
"1","  1"
"1","    270.63"
"1"," 11349"
"1"," 1599.8"
"1","
- rad    "
"1","  1"
"1","    479.15"
"1"," 11558"
"1"," 1609.1"
"1","
- nox    "
"1","  1"
"1","    487.16"
"1"," 11566"
"1"," 1609.4"
"1","
- ptratio"
"1","  1"
"1","   1194.23"
"1"," 12273"
"1"," 1639.4"
"1","
- dis    "
"1","  1"
"1","   1232.41"
"1"," 12311"
"1"," 1641.0"
"1","
- rm     "
"1","  1"
"1","   1871.32"
"1"," 12950"
"1"," 1666.6"
"1","
- lstat  "
"1","  1"
"1","   2410.84"
"1"," 13490"
"1"," 1687.3"
"1","
"
"1","
Step:  AIC="
"1",""
"1","1587.65"
"1",""
"1","
"
"1",""
"1","medv ~ crim + zn + indus + chas + nox + rm + dis + rad + tax + "
"1",""
"1","
    ptratio + b + lstat"
"1",""
"1","

"
"1","         "
"1"," Df"
"1"," Sum of Sq"
"1","   RSS"
"1","    AIC"
"1","
- indus  "
"1","  1"
"1","      2.52"
"1"," 11081"
"1"," 1585.8"
"1","
<none>   "
"1","   "
"1","          "
"1"," 11079"
"1"," 1587.7"
"1","
- chas   "
"1","  1"
"1","    219.91"
"1"," 11299"
"1"," 1595.6"
"1","
- tax    "
"1","  1"
"1","    242.24"
"1"," 11321"
"1"," 1596.6"
"1","
- crim   "
"1","  1"
"1","    243.20"
"1"," 11322"
"1"," 1596.6"
"1","
- zn     "
"1","  1"
"1","    260.32"
"1"," 11339"
"1"," 1597.4"
"1","
- b      "
"1","  1"
"1","    272.26"
"1"," 11351"
"1"," 1597.9"
"1","
- rad    "
"1","  1"
"1","    481.09"
"1"," 11560"
"1"," 1607.2"
"1","
- nox    "
"1","  1"
"1","    520.87"
"1"," 11600"
"1"," 1608.9"
"1","
- ptratio"
"1","  1"
"1","   1200.23"
"1"," 12279"
"1"," 1637.7"
"1","
- dis    "
"1","  1"
"1","   1352.26"
"1"," 12431"
"1"," 1643.9"
"1","
- rm     "
"1","  1"
"1","   1959.55"
"1"," 13038"
"1"," 1668.0"
"1","
- lstat  "
"1","  1"
"1","   2718.88"
"1"," 13798"
"1"," 1696.7"
"1","
"
"1","
Step:  AIC="
"1",""
"1","1585.76"
"1",""
"1","
"
"1",""
"1","medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + "
"1",""
"1","
    b + lstat"
"1",""
"1","

"
"1","         "
"1"," Df"
"1"," Sum of Sq"
"1","   RSS"
"1","    AIC"
"1","
<none>   "
"1","   "
"1","          "
"1"," 11081"
"1"," 1585.8"
"1","
- chas   "
"1","  1"
"1","    227.21"
"1"," 11309"
"1"," 1594.0"
"1","
- crim   "
"1","  1"
"1","    245.37"
"1"," 11327"
"1"," 1594.8"
"1","
- zn     "
"1","  1"
"1","    257.82"
"1"," 11339"
"1"," 1595.4"
"1","
- b      "
"1","  1"
"1","    270.82"
"1"," 11352"
"1"," 1596.0"
"1","
- tax    "
"1","  1"
"1","    273.62"
"1"," 11355"
"1"," 1596.1"
"1","
- rad    "
"1","  1"
"1","    500.92"
"1"," 11582"
"1"," 1606.1"
"1","
- nox    "
"1","  1"
"1","    541.91"
"1"," 11623"
"1"," 1607.9"
"1","
- ptratio"
"1","  1"
"1","   1206.45"
"1"," 12288"
"1"," 1636.0"
"1","
- dis    "
"1","  1"
"1","   1448.94"
"1"," 12530"
"1"," 1645.9"
"1","
- rm     "
"1","  1"
"1","   1963.66"
"1"," 13045"
"1"," 1666.3"
"1","
- lstat  "
"1","  1"
"1","   2723.48"
"1"," 13805"
"1"," 1695.0"
"1","
"
"1","
Call:
"
"1",""
"1","lm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad + 
    tax + ptratio + b + lstat, data = tempBoston)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-15.5984 "
"1"," -2.7386 "
"1"," -0.5046 "
"1","  1.7273 "
"1"," 26.2373 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","  22.5328"
"1","     0.2106"
"1"," 107.018"
"1","  < 2e-16"
"1"," ***"
"1","
crim       "
"1","  -0.9325"
"1","     0.2820"
"1","  -3.307"
"1"," 0.001010"
"1"," ** "
"1","
zn         "
"1","   1.0692"
"1","     0.3154"
"1","   3.390"
"1"," 0.000754"
"1"," ***"
"1","
chas       "
"1","   0.6905"
"1","     0.2170"
"1","   3.183"
"1"," 0.001551"
"1"," ** "
"1","
nox        "
"1","  -2.0135"
"1","     0.4097"
"1","  -4.915"
"1"," 1.21e-06"
"1"," ***"
"1","
rm         "
"1","   2.6711"
"1","     0.2855"
"1","   9.356"
"1","  < 2e-16"
"1"," ***"
"1","
dis        "
"1","  -3.1432"
"1","     0.3911"
"1","  -8.037"
"1"," 6.84e-15"
"1"," ***"
"1","
rad        "
"1","   2.6088"
"1","     0.5521"
"1","   4.726"
"1"," 3.00e-06"
"1"," ***"
"1","
tax        "
"1","  -1.9850"
"1","     0.5684"
"1","  -3.493"
"1"," 0.000521"
"1"," ***"
"1","
ptratio    "
"1","  -2.0492"
"1","     0.2794"
"1","  -7.334"
"1"," 9.24e-13"
"1"," ***"
"1","
b          "
"1","   0.8482"
"1","     0.2441"
"1","   3.475"
"1"," 0.000557"
"1"," ***"
"1","
lstat      "
"1","  -3.7316"
"1","     0.3387"
"1"," -11.019"
"1","  < 2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","4.736"
"1"," "
"1","on"
"1"," "
"1","494"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.7406"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.7348"
"1"," "
"1","
F-statistic:"
"1"," "
"1","128.2"
"1"," "
"1","on"
"1"," "
"1","11"
"1"," "
"1","and"
"1"," "
"1","494"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","aicselect <- step(lm_model)"
"1","Start:  AIC="
"1",""
"1","1589.64"
"1",""
"1","
"
"1",""
"1","medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + "
"1",""
"1","
    tax + ptratio + b + lstat"
"1",""
"1","

"
"1","         "
"1"," Df"
"1"," Sum of Sq"
"1","   RSS"
"1","    AIC"
"1","
- age    "
"1","  1"
"1","      0.06"
"1"," 11079"
"1"," 1587.7"
"1","
- indus  "
"1","  1"
"1","      2.52"
"1"," 11081"
"1"," 1587.8"
"1","
<none>   "
"1","   "
"1","          "
"1"," 11079"
"1"," 1589.6"
"1","
- chas   "
"1","  1"
"1","    218.97"
"1"," 11298"
"1"," 1597.5"
"1","
- tax    "
"1","  1"
"1","    242.26"
"1"," 11321"
"1"," 1598.6"
"1","
- crim   "
"1","  1"
"1","    243.22"
"1"," 11322"
"1"," 1598.6"
"1","
- zn     "
"1","  1"
"1","    257.49"
"1"," 11336"
"1"," 1599.3"
"1","
- b      "
"1","  1"
"1","    270.63"
"1"," 11349"
"1"," 1599.8"
"1","
- rad    "
"1","  1"
"1","    479.15"
"1"," 11558"
"1"," 1609.1"
"1","
- nox    "
"1","  1"
"1","    487.16"
"1"," 11566"
"1"," 1609.4"
"1","
- ptratio"
"1","  1"
"1","   1194.23"
"1"," 12273"
"1"," 1639.4"
"1","
- dis    "
"1","  1"
"1","   1232.41"
"1"," 12311"
"1"," 1641.0"
"1","
- rm     "
"1","  1"
"1","   1871.32"
"1"," 12950"
"1"," 1666.6"
"1","
- lstat  "
"1","  1"
"1","   2410.84"
"1"," 13490"
"1"," 1687.3"
"1","
"
"1","
Step:  AIC="
"1",""
"1","1587.65"
"1",""
"1","
"
"1",""
"1","medv ~ crim + zn + indus + chas + nox + rm + dis + rad + tax + "
"1",""
"1","
    ptratio + b + lstat"
"1",""
"1","

"
"1","         "
"1"," Df"
"1"," Sum of Sq"
"1","   RSS"
"1","    AIC"
"1","
- indus  "
"1","  1"
"1","      2.52"
"1"," 11081"
"1"," 1585.8"
"1","
<none>   "
"1","   "
"1","          "
"1"," 11079"
"1"," 1587.7"
"1","
- chas   "
"1","  1"
"1","    219.91"
"1"," 11299"
"1"," 1595.6"
"1","
- tax    "
"1","  1"
"1","    242.24"
"1"," 11321"
"1"," 1596.6"
"1","
- crim   "
"1","  1"
"1","    243.20"
"1"," 11322"
"1"," 1596.6"
"1","
- zn     "
"1","  1"
"1","    260.32"
"1"," 11339"
"1"," 1597.4"
"1","
- b      "
"1","  1"
"1","    272.26"
"1"," 11351"
"1"," 1597.9"
"1","
- rad    "
"1","  1"
"1","    481.09"
"1"," 11560"
"1"," 1607.2"
"1","
- nox    "
"1","  1"
"1","    520.87"
"1"," 11600"
"1"," 1608.9"
"1","
- ptratio"
"1","  1"
"1","   1200.23"
"1"," 12279"
"1"," 1637.7"
"1","
- dis    "
"1","  1"
"1","   1352.26"
"1"," 12431"
"1"," 1643.9"
"1","
- rm     "
"1","  1"
"1","   1959.55"
"1"," 13038"
"1"," 1668.0"
"1","
- lstat  "
"1","  1"
"1","   2718.88"
"1"," 13798"
"1"," 1696.7"
"1","
"
"1","
Step:  AIC="
"1",""
"1","1585.76"
"1",""
"1","
"
"1",""
"1","medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + "
"1",""
"1","
    b + lstat"
"1",""
"1","

"
"1","         "
"1"," Df"
"1"," Sum of Sq"
"1","   RSS"
"1","    AIC"
"1","
<none>   "
"1","   "
"1","          "
"1"," 11081"
"1"," 1585.8"
"1","
- chas   "
"1","  1"
"1","    227.21"
"1"," 11309"
"1"," 1594.0"
"1","
- crim   "
"1","  1"
"1","    245.37"
"1"," 11327"
"1"," 1594.8"
"1","
- zn     "
"1","  1"
"1","    257.82"
"1"," 11339"
"1"," 1595.4"
"1","
- b      "
"1","  1"
"1","    270.82"
"1"," 11352"
"1"," 1596.0"
"1","
- tax    "
"1","  1"
"1","    273.62"
"1"," 11355"
"1"," 1596.1"
"1","
- rad    "
"1","  1"
"1","    500.92"
"1"," 11582"
"1"," 1606.1"
"1","
- nox    "
"1","  1"
"1","    541.91"
"1"," 11623"
"1"," 1607.9"
"1","
- ptratio"
"1","  1"
"1","   1206.45"
"1"," 12288"
"1"," 1636.0"
"1","
- dis    "
"1","  1"
"1","   1448.94"
"1"," 12530"
"1"," 1645.9"
"1","
- rm     "
"1","  1"
"1","   1963.66"
"1"," 13045"
"1"," 1666.3"
"1","
- lstat  "
"1","  1"
"1","   2723.48"
"1"," 13805"
"1"," 1695.0"
"1","
"
"0","aicselect$coefficients %>% as.data.frame"
