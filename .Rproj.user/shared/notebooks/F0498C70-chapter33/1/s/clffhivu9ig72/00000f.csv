"0","# クラスターを計算"
"0","karate_clus <- data.frame("
"0","  vertex = as.character(1:34) |> factor(levels=1:34),"
"0","  karate = if_else(karate_col == ""A"", 1, 2),"
"0","  edge_betweenness = cluster_edge_betweenness(karate)$membership,"
"0","  fast_greedy = cluster_fast_greedy(karate)$membership,"
"0","  fluid_communities = cluster_fluid_communities(karate, no.of.communities = 2)$membership,"
"0","  infomap = cluster_infomap(karate)$membership,"
"0","  label_prop = cluster_label_prop(karate)$membership,"
"0","  leading_eigen = cluster_leading_eigen(karate)$membership,"
"0","  optimal = cluster_optimal(karate)$membership,"
"0","  spinglass = cluster_spinglass(karate)$membership,"
"0","  walktrap = cluster_walktrap(karate)$membership"
"0",") "
"0",""
"0","karate_clus|> "
"0","  pivot_longer(2:11, names_to = ""type"", values_to = ""cluster"") |> "
"0","  mutate( # 見やすいように順番を入れ替え"
"0","    type = "
"0","      fct_relevel("
"0","        type, "
"0","        c("
"0","          ""karate"", "
"0","          ""fluid_communities"", "
"0","          ""fast_greedy"", "
"0","          ""leading_eigen"", "
"0","          ""edge_betweenness"", "
"0","          ""walktrap"", ""infomap"", "
"0","          ""label_prop"", "
"0","          ""optimal"", "
"0","          ""spinglass""))) |> "
"0","  ggplot(aes(x=type, y=vertex, color=factor(cluster), fill=factor(cluster))) +"
"0","  geom_tile()+"
"0","  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))"
"0",""
