"0","iris_temp <- iris |> filter(Species != ""setosa"") |> _[,1:3]"
"0","iris.pc2 <- prcomp(iris_temp)"
"0",""
"0","pc1 <- iris.pc2$x[,1]"
"0","pc2 <- iris.pc2$x[,2]"
"0","pc3 <- iris.pc2$x[,2]"
"0","center1 <- iris.pc2$center[1]"
"0","center2 <- iris.pc2$center[2]"
"0","center3 <- iris.pc2$center[3]"
"0",""
"0","iris_temp$pc1_Sepal.Length <- pc1 * iris.pc2$rotation[1, 1] + center1"
"0","iris_temp$pc1_Sepal.Width <- pc1 * iris.pc2$rotation[2, 1] + center2"
"0","iris_temp$pc1_Petal.Length <- pc1 * iris.pc2$rotation[3, 1] + center3"
"0","iris_temp$pc2_Sepal.Length <- pc2 * iris.pc2$rotation[1, 2] + center1"
"0","iris_temp$pc2_Sepal.Width <- pc2 * iris.pc2$rotation[2, 2] + center2"
"0","iris_temp$pc2_Petal.Length <- pc2 * iris.pc2$rotation[3, 2] + center3"
"0","iris_temp$pc3_Sepal.Length <- pc3 * iris.pc2$rotation[1, 3] + center1"
"0","iris_temp$pc3_Sepal.Width <- pc3 * iris.pc2$rotation[2, 3] + center2"
"0","iris_temp$pc3_Petal.Length <- pc3 * iris.pc2$rotation[3, 3] + center3"
"0",""
"0","pacman::p_load(plotly)"
"0",""
"0","fig <- "
"0","  plot_ly("
"0","    iris_temp, "
"0","    x=~Sepal.Length, "
"0","    y=~Sepal.Width, "
"0","    z=~Petal.Length, "
"0","    type=""scatter3d"","
"0","    mode=""markers"","
"0","    name = 'data',  "
"0","    marker=list(color=""orange"", size=3)) |> "
"0","  add_trace("
"0","    x=~pc1_Sepal.Length, "
"0","    y=~pc1_Sepal.Width, "
"0","    z=~pc1_Petal.Length, "
"0","    type=""scatter3d"", "
"0","    mode=""markers+lines"","
"0","    name = 'PC1', "
"0","    marker=list(color=""red"", size=0.1),"
"0","    line=list(color=""red"", width=5)) |> "
"0","  add_trace("
"0","    x=~pc2_Sepal.Length, "
"0","    y=~pc2_Sepal.Width, "
"0","    z=~pc2_Petal.Length, "
"0","    type=""scatter3d"","
"0","    mode=""markers+lines"","
"0","    name = 'PC2',"
"0","    marker=list(color=""red"", size=0.1),"
"0","    line=list(color=""blue"", width=5)) |> "
"0","  add_trace("
"0","    x=~pc3_Sepal.Length, "
"0","    y=~pc3_Sepal.Width, "
"0","    z=~pc3_Petal.Length, "
"0","    type=""scatter3d"", "
"0","    mode=""markers+lines"","
"0","    name = 'PC3',"
"0","    marker=list(color=""red"", size=0.1),"
"0","    line=list(color=""green"", width=5))"
"0",""
"0","fig"
